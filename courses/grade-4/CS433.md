
# CS433 并行与分布式程序设计

> 如果你愿意提供任何信息与观点，请在下方评论区留言，网站维护者会在第一时间看到，且会酌情将其添加为本课程页面的内容⚡️

## 课程简介

CS433 并行与分布式程序设计，以学习使用不同的并行框架进行编程为主，其中穿插了一定的并行有关理论知识（与EI338 计算机系统工程有一定的重叠）、并行编程的优化手段。

课程主要包括以下并行框架的内容，以及相应能在课程中掌握的核心内容：

- OpenMP（基于shared-memory的并行编程）
  - 使用OMP创建和管理线程
  - 使用OMP的loop parallelism和loop scheduling快速实现简单的循环并行
  - 基于OMP的线程同步手段
- CUDA（GPU并行编程）
  - CUDA流并行架构的基本原理（理解GPU工作原理）
  - CUDA核函数编写和基本的核函数调用
  - 矩阵运算的优化技巧（矩阵乘法的Tiling技巧非常重要）
- 华为升腾处理器NPU编程（2019秋季学期新加入）
  - 这部分课程体验极差，没有核心内容可以总结，下文继续吐槽
- MPI（基于message-passing的分布式并行编程）
  - 使用MPI创建和管理进程
  - 使用MPI在进程间分发、回收数据

2019秋季学期课程网站：[http://acalab.sjtu.edu.cn/CN/Show.aspx?infolb=5&infoid=170&flag=5](http://acalab.sjtu.edu.cn/CN/Show.aspx?infolb=5&infoid=170&flag=5)

## 授课教师

2019秋季学期由电院的[梁晓峰](http://acalab.sjtu.edu.cn/CN/show.aspx?infolb=3&infoid=149&flag=3)老师授课，个人认为梁老师的教学水平在交大属于85+/100。（似乎与校园司令上的信息有出入）

## 授课方式

梁老师上课主要通过结合slides内容来讲解，讲授内容和slides内容一致，但会辅以比slides更清楚的解释（slides的内容和风格有点out-dated）。
梁老师会对一些看似比较基本的现象给出较深入的解释，会提出一些有深度的问题，这部分对笔者有一定的启发。

课程中关于理论的介绍与编程的讲解比例约为1:1，编程的部分都是干货，理论部分大约有一半是值得认真听的。

## 考核方式

平时作业 + 大作业

## 平时作业

对于4个并行框架各有一次编程作业，都需要写report进行一定的代码解释。

OMP和CUDA的编程作业较基本，就是实现一些基本的运算（向量、矩阵乘法，矩阵RBF核）并进行优化，课上的知识基本够用。

2019秋季学期加入的NPU编程是非常画蛇添足的，主要槽点有以下几点：
- 老师只对基本的原理做了不多的解释，没有涉及任何代码。
- 作业是以lab的形式进行的，现场由华为派来的人讲解（完全没用），跟着华为的官方教程（做的非常差，版本混乱，缺少调试细节）进行开发板上的算子开发。
- NPU编程架构设计本身有极大的问题，写程序全靠猜，直到作业完成都难以理解程序为什么能正确运行。

2019秋季学期由于时间较短，课时安排也缩短了，导致没有时间完成MPI部分的编程作业，所以老师很好心的取消了这次作业。因此，笔者并没有有关的情报，希望有人能补充。

## 大作业

大作业是两人一组，完成老师提供的项目选题。
2019秋季学期有三个选题，其中第三个是实验室项目，没有参考价值，因而不在此解释。
剩下两个选题以编程为主，工作量极大，分别是：

### Caffe优化

没错，就是那个Caffe。

这个项目前期需要你去阅读这个深度学习框架的源码，并定位对CuBLAS和CuDNN部分函数接口的调用。
然后需要手工用CUDA实现这些接口的调用，及用自己的核函数来替换掉CuBLAS和CuDNN中的函数，主要包括：
- CuBLAS中部分数学运算
- CuDNN中的卷积层、池化层等基本网络的前向和后向传播

总共大约有20个左右的顶层调用要实现。

在此基础上，需要你对自己的实现进行优化，最后打分是baseline加上bonus。Bonus是通过各个团队的实现测速跑分的排名来给出的。
这里的优化是超出课程范围的，有很多在课上没有详细讲解的优化需要学习。
（笔者团队的优化纯课内，但是最后总分还是拿了90，所以不用太担心优化的问题？）

教学团队会提供服务器给大家测试，但是稳定性较差不利于调试测速，建议自己找空余的服务器来备用。

这个项目的难点分布仅有一半是在实现和优化具体算子，剩下一半是阅读代码、定位接口调用、如何高效的把自己的实现整合到库里进行调试（写个高效的makefile）。
完成这个项目对于掌握CUDA编程（甚至是进阶的CUDA编程）有很大帮助，虽然时间会花很多，但性价比还是较高的。

### NPU算子开发

笔者没有做这个项目，所以没有有关情报，希望有人补充。

## 总结
 
总体而言，这门课适合希望了解学习上文提到的4个并行框架的同学选修，可以作为使用这些框架编程的入门课程。
除去NPU的部分（不知道以后还有没有）课程质量可以打89/100分，但是课程后期工作量较大，需要避开课多的学期慎重选课。

同时，由于在IEEE培养计划中有其他替代课程可选，~~胆小的同学~~没有必要冒掉绩点的风险（其实风险不大）来选这门课，可以通过旁听的方式来学习。
